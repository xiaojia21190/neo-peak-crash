# Neon Peak Crash - Environment Variables
#
# Copy this file to `.env.local` and fill in real values:
#   cp .env.example .env.local
#
# Secret hygiene:
# - NEVER commit `.env.local` or any `.env*.local` files.
# - Rotate secrets immediately if they are leaked (AUTH_SECRET, LINUXDO_CLIENT_SECRET, LDC_CLIENT_SECRET, ADMIN_TOKEN).
# - Prefer managed secrets in your hosting provider (e.g. Vercel env vars) for production.

# ------------------------------------------------------------------------------
# Core / URLs
# ------------------------------------------------------------------------------

# Public site URL (used by NextAuth callbacks + payment callback URLs)
NEXTAUTH_URL="http://localhost:3000"

# WebSocket server URL used by the browser client
NEXT_PUBLIC_WS_URL="http://localhost:3001"

# ------------------------------------------------------------------------------
# Auth (Auth.js / NextAuth v5)
# ------------------------------------------------------------------------------

# Required in production. Generate:
#   openssl rand -base64 32
AUTH_SECRET="your-auth-secret-here"

# Backwards compatible (only used if AUTH_SECRET is unset)
# NEXTAUTH_SECRET="your-auth-secret-here"

# ------------------------------------------------------------------------------
# Database (PostgreSQL / Prisma)
# ------------------------------------------------------------------------------

DATABASE_URL="postgresql://USER:PASSWORD@HOST:5432/DATABASE"

# ------------------------------------------------------------------------------
# Redis
# ------------------------------------------------------------------------------

# Default: redis://localhost:6379
# REDIS_URL="redis://HOST:6379"

# ------------------------------------------------------------------------------
# Linux DO OAuth2 (https://connect.linux.do)
# ------------------------------------------------------------------------------

LINUXDO_CLIENT_ID="your-linuxdo-client-id"
LINUXDO_CLIENT_SECRET="your-linuxdo-client-secret"

# Optional overrides (usually keep defaults)
# LINUXDO_AUTHORIZATION_URL="https://connect.linux.do/oauth2/authorize"
# LINUXDO_TOKEN_URL="https://connect.linux.do/oauth2/token"
# LINUXDO_USERINFO_URL="https://connect.linux.do/api/user"

# ------------------------------------------------------------------------------
# Linux DO Credit / EasyPay payment (https://credit.linux.do)
# ------------------------------------------------------------------------------

LDC_CLIENT_ID="your-ldc-client-id"
LDC_CLIENT_SECRET="your-ldc-client-secret"

# Payment gateway base URL (default: https://credit.linux.do/epay)
# LDC_GATEWAY="https://credit.linux.do/epay"

# Optional: proxy the LDC API (debugging / bypass Cloudflare in some regions)
# LDC_PROXY_URL="https://your-proxy.example.com/epay"

# ------------------------------------------------------------------------------
# Game server (WebSocket)
# ------------------------------------------------------------------------------

# Game server HTTP port (default: 3001)
# PORT=3001

# Comma-separated list of allowed origins (default: http://localhost:3000)
# WS_CORS_ORIGIN="http://localhost:3000,https://your-domain.com"

# Heartbeat interval for server-wide PONG broadcast (ms; default: 25000)
# WS_HEARTBEAT_INTERVAL_MS=25000

# Whether to replay current round bets after reconnect (default: true)
# WS_REPLAY_CURRENT_ROUND_BETS=true

# State snapshot history limit (0-200; default: 20)
# WS_STATE_HISTORY_LIMIT=20

# ------------------------------------------------------------------------------
# Admin / Ops
# ------------------------------------------------------------------------------

# Protects the `/stats` endpoint on the game server (Authorization: Bearer <token>)
# ADMIN_TOKEN="your-admin-token-here"

# ------------------------------------------------------------------------------
# Rate limiting
# ------------------------------------------------------------------------------

# Enable Redis-backed rate limiting (default: true; falls back to in-memory if Redis is down)
# RATE_LIMIT_REDIS_ENABLED=true

# Redis key prefix for bet rate limiting (default: rate:bet:)
# RATE_LIMIT_REDIS_PREFIX="rate:bet:"

# Sliding window size for bet rate limiting (ms; default: 1000)
# RATE_LIMIT_WINDOW_MS=1000

# Recharge (deposit) endpoint rate limit
# RECHARGE_RATE_LIMIT_WINDOW_MS=60000
# RECHARGE_RATE_LIMIT_MAX=5

# Daily recharge limit per user (default: 50000)
# DAILY_RECHARGE_LIMIT=50000

# ------------------------------------------------------------------------------
# Financial / risk controls
# ------------------------------------------------------------------------------

# Max single financial operation amount (default: 1000000)
# MAX_FINANCIAL_AMOUNT=1000000

# Max payout ratio per round (<=1 means ratio of pool; default: 0.15)
# MAX_ROUND_PAYOUT=0.15

# Initial house pool balance if missing in DB (default: 100000)
# HOUSE_POOL_BALANCE=100000
# GAME_POOL_BALANCE=100000

# ------------------------------------------------------------------------------
# Performance tuning
# ------------------------------------------------------------------------------

# Max active bets per round (default: 10000)
# MAX_ACTIVE_BETS=10000

# Price sampling interval (ms; default: 50)
# PRICE_SAMPLE_MS=50

# Redis price write sampling interval (ms; default: 50)
# REDIS_SAMPLE_MS=50

# Price proxy URL (optional, e.g. to route Bybit WS via proxy)
# PROXY_URL="https://your-proxy.example.com"

# ------------------------------------------------------------------------------
# Snapshot / persistence tuning
# ------------------------------------------------------------------------------

# Max snapshot queue size (default: 10000)
# MAX_SNAPSHOT_QUEUE=10000

# Snapshot flush batch size (default: 500)
# SNAPSHOT_FLUSH_BATCH_SIZE=500

# Snapshot flush retry base delay (ms; default: 1000)
# SNAPSHOT_FLUSH_RETRY_BASE_MS=1000

# Snapshot flush retry max delay (ms; default: 30000)
# SNAPSHOT_FLUSH_RETRY_MAX_MS=30000

# ------------------------------------------------------------------------------
# Node
# ------------------------------------------------------------------------------

# NODE_ENV is usually set by the runtime; keep unset locally unless needed.
# NODE_ENV=development
